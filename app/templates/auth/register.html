{% extends 'base.html' %}

{% block title %}Cadastro{% endblock %}

{% block content %}
<div class="max-w-md mx-auto mt-10 p-6 bg-white rounded-xl shadow">
    <h2 class="text-2xl font-bold mb-4">Cadastro</h2>
    <form id="register-form">
        <input type="text" name="cpf" placeholder="CPF" class="border p-2 w-full mb-4 rounded">
        <input type="email" name="email" placeholder="Email" class="border p-2 w-full mb-4 rounded">
        <input type="text" name="telefone" placeholder="Telefone" class="border p-2 w-full mb-4 rounded">
        <input type="text" name="endereco" placeholder="Endereço" class="border p-2 w-full mb-4 rounded">
        <input type="password" name="password" placeholder="Senha" class="border p-2 w-full mb-4 rounded">
        <button type="submit" class="w-full bg-[#1980e6] text-white py-2 rounded">Cadastrar</button>
    </form>
</div>

<script>
document.getElementById('register-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const form = e.target;
    const data = {
        cpf: form.cpf.value,
        email: form.email.value,
        telefone: form.telefone.value,
        endereco: form.endereco.value,
        password: form.password.value
    };

    const response = await fetch('/auth/users/', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
    });

    if (response.ok) {
        alert('Cadastro realizado! Faça login.');
        window.location.href = '/login/';
    } else {
        const error = await response.json();
        alert('Erro: ' + JSON.stringify(error));
    }
});
</script>
{% endblock %}
